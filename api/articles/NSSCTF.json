{"title":"NSSctf做题笔记","uid":"d7040ad39556c1158409d9d4cfbb3e26","slug":"NSSCTF","date":"2025-11-17T10:42:39.846Z","updated":"2025-11-17T15:49:01.857Z","comments":true,"path":"api/articles/NSSCTF.json","keywords":["Wclxd","blog","personal"],"cover":[],"content":"<h1 id=\"从-Nikto-扫描到获取-Shell-的完整解题思路梳理\"><a href=\"#从-Nikto-扫描到获取-Shell-的完整解题思路梳理\" class=\"headerlink\" title=\"从 Nikto 扫描到获取 Shell 的完整解题思路梳理\"></a>从 Nikto 扫描到获取 Shell 的完整解题思路梳理</h1><h2 id=\"知识点：-Nikto扫描-，PUT文件上传-RCE\"><a href=\"#知识点：-Nikto扫描-，PUT文件上传-RCE\" class=\"headerlink\" title=\"知识点： Nikto扫描 ，PUT文件上传 ,RCE\"></a>知识点： Nikto扫描 ，PUT文件上传 ,RCE</h2><p><img src=\"/image.png\" alt=\"alt text\"><br>一、核心线索链（从发现到利用的全流程）<br>初始定位：通过 HTTP 请求包得知目标 node4.anna.nssctf.cn:28017，初步判断是 CTF Web &#x2F; 服务类题目；</p>\n<h3 id=\"服务探测：nmap-扫描显示端口开放且标注为mongod，但后续-MongoDB-客户端连接失败（版本兼容-实际服务类型误判）；\"><a href=\"#服务探测：nmap-扫描显示端口开放且标注为mongod，但后续-MongoDB-客户端连接失败（版本兼容-实际服务类型误判）；\" class=\"headerlink\" title=\"服务探测：nmap 扫描显示端口开放且标注为mongod，但后续 MongoDB 客户端连接失败（版本兼容 + 实际服务类型误判）；\"></a>服务探测：nmap 扫描显示端口开放且标注为mongod，但后续 MongoDB 客户端连接失败（版本兼容 + 实际服务类型误判）；</h3><p><img src=\"/image-1.png\" alt=\"alt text\"><br>关键转折：curl 访问目标端口，发现实际是 Apache+PHP Web 服务（highlight_file(<strong>FILE</strong>) 暴露 PHP 环境）；<br>漏洞挖掘：Nikto 扫描爆出核心漏洞 ——HTTP PUT 方法开启（允许客户端向服务器上传文件）；<br>漏洞利用：<br>利用 PUT 方法上传 PHP 脚本，先读取目标源码和目录结构，确认 flag 不在当前目录；<br><img src=\"/image-2.png\" alt=\"alt text\"><br>优化脚本，上传支持 GET 参数的 PHP 一句话 Shell，通过?cmd&#x3D;xxx执行系统命令；<br><img src=\"/image-3.png\" alt=\"alt text\"><br>最终通过 Shell 读取根目录 flag，完成解题。<br><img src=\"/image-4.png\" alt=\"alt text\"><br>二、每一步的核心目的与逻辑</p>\n<ol>\n<li>服务探测阶段（nmap+curl）<br>目的：明确目标端口对应的真实服务类型（避免被初始标注误导）；<br>关键逻辑：<br>nmap 标注mongod但客户端连接失败 → 怀疑服务类型误判；<br>curl 直接访问端口 → 确认是 Web 服务（PHP 环境），推翻之前 MongoDB 的方向；<br>核心结论：从 “数据库服务” 转向 “Web 服务漏洞利用”。</li>\n<li>漏洞扫描阶段（Nikto）<br>目的：快速发现 Web 服务的潜在漏洞和配置缺陷；<br>关键逻辑：<br>Nikto 扫描重点关注 “高危可利用漏洞”，忽略单纯的安全配置问题（如缺失 X-Frame-Options 头）；<br>锁定核心漏洞：HTTP PUT方法开启 → 直接突破点（可上传文件 &#x3D; 获取服务器操作权限）；<br>补充信息：确认 Apache+PHP 版本（无已知高危版本漏洞，无需额外绕路）。</li>\n<li>漏洞利用阶段（PUT 上传 + Shell 构造）<br>目的：通过 PUT 上传获取服务器权限，最终定位并读取 flag；<br>分步骤逻辑：<br>第一步：上传基础 PHP 脚本（读源码 + 列目录）→ 排查 flag 是否在当前目录 &#x2F; 源码中；<br>第二步：排查无果后，上传支持 GET 参数的一句话 Shell → 灵活执行系统命令（突破当前目录限制）；<br>第三步：通过 Shell 执行cat &#x2F;flag（CTF 根目录 flag 高频位置）→ 直接获取 flag；<br>核心思路：从 “被动读取” 到 “主动执行”，逐步扩大操作范围。<br>三、关键决策点与避坑总结</li>\n<li>避免 “标签误导”<br>坑：nmap 标注mongod就死磕 MongoDB 客户端兼容问题；<br>解：当客户端连接失败时，立刻用 curl &#x2F; 浏览器访问端口，验证是否为 Web 服务（端口可复用，标注不一定 100% 准确）。</li>\n<li>聚焦 “可利用漏洞”<br>坑：被 Nikto 输出的大量信息干扰（如版本过时、配置缺失）；<br>解：优先筛选 “能直接操作服务器” 的漏洞（如 PUT 上传、文件包含、命令执行），这类漏洞是 CTF 解题的 “捷径”。</li>\n<li>脚本构造 “从简到繁”<br>坑：一开始写复杂脚本导致语法错误（如之前read_flag.php报错）；<br>解：先上传极简脚本（如单行走读文件、列目录），验证功能正常后，再扩展为支持参数的 Shell（降低调试成本）。</li>\n<li>利用 “CTF 惯例” 缩短路径<br>核心惯例：flag 常藏在&#x2F;flag（根目录无后缀）、&#x2F;flag.txt、当前目录flag.php；<br>逻辑：无需盲目遍历全系统，先尝试高频位置，再通过 Shell 扩大范围（提高效率）。</li>\n</ol>\n","feature":true,"text":"从 Nikto 扫描到获取 Shell 的完整解题思路梳理知识点： Nikto扫描 ，PUT文件上传 ,RCE一、核心线索链（从发现到利用的全流程）初始定位：通...","permalink":"/post/NSSCTF","photos":[],"count_time":{"symbolsCount":"1.6k","symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"-ctf","slug":"ctf","count":1,"path":"api/tags/ctf.json"}],"toc":"<ol class=\"toc\"><li class=\"toc-item toc-level-1\"><a class=\"toc-link\" href=\"#%E4%BB%8E-Nikto-%E6%89%AB%E6%8F%8F%E5%88%B0%E8%8E%B7%E5%8F%96-Shell-%E7%9A%84%E5%AE%8C%E6%95%B4%E8%A7%A3%E9%A2%98%E6%80%9D%E8%B7%AF%E6%A2%B3%E7%90%86\"><span class=\"toc-text\">从 Nikto 扫描到获取 Shell 的完整解题思路梳理</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-2\"><a class=\"toc-link\" href=\"#%E7%9F%A5%E8%AF%86%E7%82%B9%EF%BC%9A-Nikto%E6%89%AB%E6%8F%8F-%EF%BC%8CPUT%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-RCE\"><span class=\"toc-text\">知识点： Nikto扫描 ，PUT文件上传 ,RCE</span></a><ol class=\"toc-child\"><li class=\"toc-item toc-level-3\"><a class=\"toc-link\" href=\"#%E6%9C%8D%E5%8A%A1%E6%8E%A2%E6%B5%8B%EF%BC%9Anmap-%E6%89%AB%E6%8F%8F%E6%98%BE%E7%A4%BA%E7%AB%AF%E5%8F%A3%E5%BC%80%E6%94%BE%E4%B8%94%E6%A0%87%E6%B3%A8%E4%B8%BAmongod%EF%BC%8C%E4%BD%86%E5%90%8E%E7%BB%AD-MongoDB-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5%E5%A4%B1%E8%B4%A5%EF%BC%88%E7%89%88%E6%9C%AC%E5%85%BC%E5%AE%B9-%E5%AE%9E%E9%99%85%E6%9C%8D%E5%8A%A1%E7%B1%BB%E5%9E%8B%E8%AF%AF%E5%88%A4%EF%BC%89%EF%BC%9B\"><span class=\"toc-text\">服务探测：nmap 扫描显示端口开放且标注为mongod，但后续 MongoDB 客户端连接失败（版本兼容 + 实际服务类型误判）；</span></a></li></ol></li></ol></li></ol>","author":{"name":"Wclxd","slug":"blog-author","avatar":"/image/logo.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"github":{"icon":"fab fa-github","link":"https://github.com/lixingdao"},"email":{"icon":"fas fa-envelope","link":"mailto:3107878660@qq.com"}}}},"mapped":true,"hidden":false,"prev_post":{},"next_post":{"title":"使用Nmap对防火墙和IDS/IPS 规避","uid":"a03a11a291d2e8cc2f6b77138205211d","slug":"使用Nmap对防火墙和IDS/IPS 规避","date":"2025-10-16T09:47:31.000Z","updated":"2025-10-17T16:47:42.384Z","comments":true,"path":"api/articles/使用Nmap对防火墙和IDS/IPS 规避.json","keywords":["Wclxd","blog","personal"],"cover":null,"text":"防火墙防火墙是一种防止外部网络进行未经授权连接尝试的安全措施。每个防火墙安全系统都基于一个软件组件，该组件监控防火墙与传入数据连接之间的网络流量，并根据已设置的...","permalink":"/post/使用Nmap对防火墙和IDS/IPS 规避","photos":[],"count_time":{"symbolsCount":265,"symbolsTime":"1 mins."},"categories":[],"tags":[{"name":"tools","slug":"tools","count":1,"path":"api/tags/tools.json"}],"author":{"name":"Wclxd","slug":"blog-author","avatar":"/image/logo.png","link":"/","description":"","socials":{"github":"","twitter":"","stackoverflow":"","wechat":"","qq":"","weibo":"","zhihu":"","csdn":"","juejin":"","customs":{"github":{"icon":"fab fa-github","link":"https://github.com/lixingdao"},"email":{"icon":"fas fa-envelope","link":"mailto:3107878660@qq.com"}}}},"feature":true}}